# 開発環境の構築

## 必要ツール

- docker 28.2.2 (linux/amd64の場合)
- docker compose version v2.37.1
- uv 0.8.0

## ローカル環境構築

1. uvのインストール後にpyproject.tomlのあるディレクトリで`uv sync --extra dev`を実行
2. powershellは`.venv\Scripts\Activate.ps1`、cmdは`.venv\Scripts\activate.bat`、linuxは`source .venv/bin/activate`を実行して仮想環境をアクティベート
3. appディレクトリに移動し、`uvicorn main:app --reload --port  8000`を実行するとfastapiのサーバーが立つ...はず

## コンテナ環境

1. compose.ymlがあるディレクトリで`docker compose up --build`を実行することでアプリとデータベースのコンテナが起動できる。
2. DB接続方法はdocker composeで起動した後`docker exec -it 0810hackathon-back-db-1 psql -U user -d mydatabase`を実行するとDBの操作が可能。

## ruffの設定方法・使い方

### コマンドラインから

1. ruffはインストールされているはずなので、とりあえず`uv run ruff check path/to/code/`でlint(コードの問題点を検出),`uv run ruff format path/to/code/`でformat(コードのスタイルチェック)ができる。pathを指定しなかったらプロジェクト全体が読み込まれる。
2. `ruff check path/to/code/ --fix`でコードの修正を自動で行える。修正内容をファイルに書き込まずに、修正内容を確認したい場合は`ruff check path/to/code/ --diff`

### VSCodeから

まず、Visual Studio Marketplace から公式の Ruff 拡張機能をインストールする。

1. VS Code を開く。
2. 拡張機能ビュー (`Ctrl+Shift+X`) に移動する。
3. 「Ruff」を検索し、Astral Software が公開している拡張機能をインストールする。
4.  完了！保存したら自動でFormatterが適用されるはず。スタイルに合ってない場所は黄色い波線で警告が表示され、波線にカーソルを合わせると原因が表示される。詳細な原因を確認するには青色のurlをクリックするとruffのドキュメントに飛ばされる
5.  警告を無効化したいときは`pyproject.toml`の`ruff.lint.ignore`に無効化したいルールのIDを設定する